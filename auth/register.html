<!DOCTYPE html>
<html>
<head>
  <title>Register</title>
</head>
<body>

<h2>Register</h2>

<input type="email" id="email" placeholder="Email"><br><br>
<input type="password" id="password" placeholder="Password (min 8 chars)"><br><br>

<label>Register as:</label><br>
<select id="role">
  <option value="">-- Select Role --</option>
  <option value="customer">Customer</option>
  <option value="vendor">Vendor</option>
</select><br><br>

<button id="registerBtn">Register</button>
<p id="msg"></p>

<script type="module">
import { auth, db } from "../firebase.js";
import { createUserWithEmailAndPassword }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { doc, setDoc }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

registerBtn.onclick = async () => {
  try {
    if (!role.value) throw "Please select a role";

    const cred = await createUserWithEmailAndPassword(
      auth, email.value, password.value
    );

    await setDoc(doc(db, "users", cred.user.uid), {
      email: email.value,
      role: role.value,
      createdAt: Date.now()
    });

    msg.innerText = "Registration successful";
    setTimeout(() => location.href = "login.html", 1000);

  } catch (err) {
    msg.innerText = err;
  }
};
</script>

</body>
</html>
